<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gun Violence Data Report | 2015-2024</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', system-ui, sans-serif;
            background: #ffffff;
            color: #1a1a1a;
            line-height: 1.6;
            padding: 0;
            margin: 0;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 60px 40px;
        }

        header {
            border-bottom: 1px solid #e0e0e0;
            padding-bottom: 40px;
            margin-bottom: 60px;
        }

        h1 {
            font-size: 48px;
            font-weight: 300;
            letter-spacing: -1px;
            margin-bottom: 16px;
            color: #000000;
        }

        .subtitle {
            font-size: 18px;
            color: #666666;
            font-weight: 300;
        }

        .section {
            margin-bottom: 80px;
        }

        .section-title {
            font-size: 28px;
            font-weight: 400;
            margin-bottom: 24px;
            color: #000000;
            letter-spacing: -0.5px;
        }

        .section-subtitle {
            font-size: 14px;
            text-transform: uppercase;
            letter-spacing: 2px;
            color: #999999;
            margin-bottom: 12px;
            font-weight: 500;
        }

        .executive-summary {
            background: #f8f8f8;
            padding: 40px;
            border-left: 3px solid #000000;
            margin-bottom: 60px;
        }

        .executive-summary p {
            font-size: 16px;
            margin-bottom: 16px;
            color: #333333;
        }

        .stat-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 30px;
            margin-top: 30px;
        }

        .stat-card {
            background: #ffffff;
            padding: 30px;
            border: 1px solid #e0e0e0;
            transition: transform 0.2s ease, box-shadow 0.2s ease;
        }

        .stat-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
        }

        .stat-value {
            font-size: 42px;
            font-weight: 300;
            color: #000000;
            margin-bottom: 8px;
        }

        .stat-label {
            font-size: 13px;
            color: #666666;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .data-sources {
            font-size: 14px;
            color: #666666;
            line-height: 1.8;
        }

        .data-sources ul {
            list-style: none;
            padding-left: 0;
        }

        .data-sources li {
            margin-bottom: 12px;
            padding-left: 20px;
            position: relative;
        }

        .data-sources li:before {
            content: "•";
            position: absolute;
            left: 0;
            color: #000000;
            font-weight: bold;
        }

        .chart-container {
            background: #ffffff;
            padding: 40px;
            border: 1px solid #e0e0e0;
            margin-top: 30px;
            position: relative;
            min-height: 400px;
        }

        .chart-description {
            font-size: 14px;
            color: #666666;
            margin-bottom: 30px;
            font-style: italic;
        }

        canvas {
            max-width: 100%;
            height: auto !important;
        }

        footer {
            margin-top: 80px;
            padding-top: 40px;
            border-top: 1px solid #e0e0e0;
            text-align: center;
            color: #999999;
            font-size: 13px;
        }

        .divider {
            height: 1px;
            background: linear-gradient(to right, transparent, #e0e0e0, transparent);
            margin: 60px 0;
        }

        @media (max-width: 768px) {
            .container {
                padding: 40px 20px;
            }

            h1 {
                font-size: 36px;
            }

            .section-title {
                font-size: 24px;
            }

            .chart-container {
                padding: 20px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>Gun Violence in America</h1>
            <p class="subtitle">A data-driven analysis of shooting incidents across U.S. states from 2015 to 2024</p>
        </header>

        <!-- Executive Summary -->
        <section class="section">
            <div class="section-subtitle">01 / Executive Summary</div>
            <h2 class="section-title">Key Findings</h2>
            
            <div class="executive-summary">
                <p>This report analyzes <strong>14,332 mass shooting incidents</strong> across the United States between 2015 and 2024, examining patterns in gun violence at both national and state levels. The data reveals significant disparities in shooting incident rates when adjusted for population size.</p>
                
                <p>District of Columbia shows the highest cumulative rate at 20.92 incidents per 100,000 residents over the period, followed by Louisiana (12.48) and Mississippi (11.24). In contrast, Hawaii (1.12), New Hampshire (1.33), and Idaho (1.45) demonstrate the lowest rates.</p>
                
                <p>National incident counts show a general upward trend, with notable increases during 2016, 2020-2021, and 2023-2024, suggesting that gun violence remains a persistent and growing public health concern.</p>
            </div>

            <div class="stat-grid">
                <div class="stat-card">
                    <div class="stat-value" id="total-incidents">14,332</div>
                    <div class="stat-label">Total Incidents</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value">52</div>
                    <div class="stat-label">States & Territories</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value">2015-2024</div>
                    <div class="stat-label">Years Analyzed</div>
                </div>
            </div>
        </section>

        <div class="divider"></div>

        <!-- Data Sources -->
        <section class="section">
            <div class="section-subtitle">02 / Data Sources</div>
            <h2 class="section-title">Methodology & Sources</h2>
            
            <div class="data-sources">
                <ul>
                    <li><strong>Gun Violence Archive (2015-2024)</strong> — Comprehensive incident-level data on all shooting incidents across the United States, including incident dates, locations, and casualty counts.</li>
                    <li><strong>U.S. Census Bureau Population Estimates</strong> — Annual state population estimates from the Population Estimates Program (PEP), used to calculate per capita rates and enable fair comparisons across states of different sizes.</li>
                    <li><strong>Analysis Period</strong> — Data covers 10 years from January 1, 2015 through December 31, 2024, encompassing 467 state-year observations.</li>
                    <li><strong>Per Capita Calculation</strong> — Incidents per 100,000 residents calculated as: (incidents / population) × 100,000. Cumulative rates represent the sum of annual per capita rates across the entire period.</li>
                </ul>
            </div>
        </section>

        <div class="divider"></div>

        <!-- Chart 1: National Cumulative Trend -->
        <section class="section">
            <div class="section-subtitle">03 / National Trends</div>
            <h2 class="section-title">Cumulative Shooting Incidents Over Time</h2>
            <p class="chart-description">
                This chart shows the cumulative total of shooting incidents nationwide from 2015 to 2024. 
                The steadily increasing trend demonstrates the persistent nature of gun violence in America.
            </p>
            
            <div class="chart-container">
                <canvas id="nationalTrendChart"></canvas>
            </div>
        </section>

        <div class="divider"></div>

        <!-- Chart 2: State Comparison -->
        <section class="section">
            <div class="section-subtitle">04 / State Comparison</div>
            <h2 class="section-title">Highest & Lowest Rates by State</h2>
            <p class="chart-description">
                Comparison of states with the highest and lowest cumulative incident rates per 100,000 residents (2015-2024). 
                Per capita rates reveal patterns not visible in raw incident counts alone.
            </p>
            
            <div class="chart-container">
                <canvas id="stateComparisonChart"></canvas>
            </div>
        </section>

        <footer>
            <p>Data Report Generated: <span id="current-date"></span></p>
            <p>Sources: Gun Violence Archive | U.S. Census Bureau</p>
        </footer>
    </div>

    <script>
        // Load the data
        fetch('report_data.json')
            .then(response => response.json())
            .then(data => {
                // Set current date
                document.getElementById('current-date').textContent = new Date().toLocaleDateString('en-US', {
                    year: 'numeric',
                    month: 'long',
                    day: 'numeric'
                });

                // Animate the total incidents counter
                animateValue('total-incidents', 0, data.summary_stats.total_incidents_2015_2024, 2000);

                // Chart 1: National Cumulative Trend
                const nationalCtx = document.getElementById('nationalTrendChart').getContext('2d');
                new Chart(nationalCtx, {
                    type: 'line',
                    data: {
                        labels: data.national_cumulative.map(d => d.year),
                        datasets: [{
                            label: 'Cumulative Incidents',
                            data: data.national_cumulative.map(d => d.cumulative_incidents),
                            borderColor: '#000000',
                            backgroundColor: 'rgba(0, 0, 0, 0.05)',
                            borderWidth: 2,
                            fill: true,
                            tension: 0.3,
                            pointRadius: 4,
                            pointHoverRadius: 6,
                            pointBackgroundColor: '#000000',
                            pointBorderColor: '#ffffff',
                            pointBorderWidth: 2
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: true,
                        aspectRatio: 2.5,
                        plugins: {
                            legend: {
                                display: false
                            },
                            tooltip: {
                                backgroundColor: '#000000',
                                titleColor: '#ffffff',
                                bodyColor: '#ffffff',
                                padding: 12,
                                displayColors: false,
                                callbacks: {
                                    label: function(context) {
                                        return 'Incidents: ' + context.parsed.y.toLocaleString();
                                    }
                                }
                            }
                        },
                        scales: {
                            y: {
                                beginAtZero: true,
                                ticks: {
                                    color: '#666666',
                                    font: {
                                        size: 11
                                    },
                                    callback: function(value) {
                                        return value.toLocaleString();
                                    }
                                },
                                grid: {
                                    color: '#f0f0f0',
                                    drawBorder: false
                                }
                            },
                            x: {
                                ticks: {
                                    color: '#666666',
                                    font: {
                                        size: 11
                                    }
                                },
                                grid: {
                                    display: false,
                                    drawBorder: false
                                }
                            }
                        }
                    }
                });

                // Chart 2: State Comparison
                const stateCtx = document.getElementById('stateComparisonChart').getContext('2d');
                
                // Combine top 5 and bottom 5
                const allStates = [...data.bottom_5_states, ...data.top_5_states];
                const stateLabels = allStates.map(d => d.state);
                const stateData = allStates.map(d => d.cumulative_rate);
                
                // Color: bottom 5 in light gray, top 5 in black
                const colors = [
                    ...Array(5).fill('#d0d0d0'),
                    ...Array(5).fill('#000000')
                ];

                new Chart(stateCtx, {
                    type: 'bar',
                    data: {
                        labels: stateLabels,
                        datasets: [{
                            label: 'Cumulative Rate per 100k',
                            data: stateData,
                            backgroundColor: colors,
                            borderColor: colors,
                            borderWidth: 0,
                            barThickness: 35
                        }]
                    },
                    options: {
                        indexAxis: 'y',
                        responsive: true,
                        maintainAspectRatio: true,
                        aspectRatio: 1.5,
                        plugins: {
                            legend: {
                                display: false
                            },
                            tooltip: {
                                backgroundColor: '#000000',
                                titleColor: '#ffffff',
                                bodyColor: '#ffffff',
                                padding: 12,
                                displayColors: false,
                                callbacks: {
                                    label: function(context) {
                                        return 'Rate: ' + context.parsed.x.toFixed(2) + ' per 100k';
                                    }
                                }
                            }
                        },
                        scales: {
                            x: {
                                beginAtZero: true,
                                ticks: {
                                    color: '#666666',
                                    font: {
                                        size: 11
                                    }
                                },
                                grid: {
                                    color: '#f0f0f0',
                                    drawBorder: false
                                }
                            },
                            y: {
                                ticks: {
                                    color: '#666666',
                                    font: {
                                        size: 11
                                    }
                                },
                                grid: {
                                    display: false,
                                    drawBorder: false
                                }
                            }
                        }
                    }
                });
            })
            .catch(error => {
                console.error('Error loading data:', error);
            });

        // Counter animation function
        function animateValue(id, start, end, duration) {
            const obj = document.getElementById(id);
            const range = end - start;
            const increment = end > start ? 1 : -1;
            const stepTime = Math.abs(Math.floor(duration / range));
            let current = start;
            
            const timer = setInterval(() => {
                current += increment * Math.ceil(range / 100);
                if ((increment > 0 && current >= end) || (increment < 0 && current <= end)) {
                    current = end;
                    clearInterval(timer);
                }
                obj.textContent = current.toLocaleString();
            }, stepTime);
        }
    </script>
</body>
</html>
